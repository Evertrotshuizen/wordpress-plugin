<?php

require_once dirname( __FILE__ ) . '/TinyTestCase.php';

/**
 * @runTestsInSeparateProcesses
 * @preserveGlobalState disabled
 */
class Tiny_Compress_Fopen_Test extends TinyTestCase {
	protected $php_mock;

	public function setUp() {
		parent::setUp();
		$php_mock = \Mockery::mock( 'alias:Tiny_PHP' );
		$php_mock->shouldReceive( 'client_library_supported' )->andReturn( false );
		$php_mock->shouldReceive( 'fopen_available' )->andReturn( true );
		$this->compressor = Tiny_Compress::create( 'api1234' );
	}

	public function testShouldReturnFopenCompressorIfClientNotSupported() {
		$this->assertInstanceOf( 'Tiny_Compress_Fopen', $this->compressor );
	}

	public function testCanCreateKeyShouldReturnFalse() {
		$this->assertSame( false, $this->compressor->can_create_key() );
	}

	public function testGetKeyShouldReturnKey() {
		$this->assertSame( 'api1234', $this->compressor->get_key() );
	}
}
